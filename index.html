<!doctype html>
<html lang="nl">
<head>
  <!-- a warm note — NL-only minimal prototype -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>a warm note to someone You care about</title>
  <meta name="description" content="Iets kleins, veel betekenis. Deel een warme boodschap — zonder ruis, met aandacht.">
  <meta name="theme-color" content="#FFE66D" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@700&family=Patrick+Hand&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css?v=dev5" />
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="assets/icons/app-192.png">
</head>
<body>

  <!-- =================== TOPBAR =================== -->
  <header class="topbar" data-topbar>
    <h1 class="brand">a warm note to someone You care about<span class="brand-payoff"></span></h1>

    <!-- Één enkele actions-nav -->
    <nav class="actions" aria-label="Acties">
      <button id="btn-new" class="btn btn-ico primary" type="button" aria-label="Nieuwe boodschap">
        <!-- “plus/note” icoon -->
        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M7 3h7l5 5v11a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z" fill="currentColor" opacity=".18"/>
          <path d="M14 3v5a2 2 0 0 0 2 2h5" fill="none" stroke="currentColor" stroke-width="1.5" opacity=".6"/>
          <path d="M12 10v6M9 13h6" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
        </svg>
        <span class="btn-label">Nieuwe boodschap</span>
      </button>

      <button id="btn-share" class="btn btn-ico" type="button" aria-label="Verstuur">
        <!-- “paper plane” icoon -->
        <svg width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M21.5 3.5 10 14l-1 6 4-3 8.5-13.5z" fill="currentColor" opacity=".18"/>
          <path d="M21.5 3.5 10 14m0 0-1 6 4-3" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <span class="btn-label">Verstuur</span>
      </button>

      <!-- ✅ PERMANENTE EXPAND-KNOP IN TOPBAR -->
      <button class="btn btn-ico" data-action="expand-note" type="button" aria-label="Bericht vergroten" title="Vergroot de note">⤢</button>
    </nav>
  </header>

  <!-- =================== APP =================== -->
  <main class="page" role="main">
    <div class="intro-hint" id="intro-hint">Tip <span class="hint-swipe">: swipe door de Gevoelens & Boodschap →</span></div>

    <!-- Sentiment chips -->
    <section class="chips-wrap" aria-label="Kies gevoel">
      <div id="chip-row" class="chip-row" role="tablist" aria-label="Gevoelsfilters"></div>
    </section>

    <!-- Note -->
    <section class="note-wrap" aria-labelledby="note-title">
      <h2 id="note-title" class="vh">Jouw warme note</h2>
      <div id="note" class="note" role="region" aria-label="Notitie met boodschap">
        <div class="tape tape--tl"></div>
        <div class="tape tape--tr"></div>
        <div id="toline"></div>
        <p id="message" class="message"></p>
        <div id="iconline"></div>
        <div class="from-wrap">
          <div id="from-symbol" aria-hidden="true"></div>
          <div id="fromline"></div>
        </div>
      </div>
    </section>

    <!-- Compose -->
    <section id="compose-strip" class="compose" aria-label="Personaliseer">
      <div class="compose-row">
        <input id="to-inline" class="compose-to" type="text" placeholder="Voor wie?" aria-required="true" aria-label="Voor wie is dit?">
        <input id="from-inline" class="compose-from" type="text" placeholder="Van jou (optioneel)" aria-label="Van wie is dit?">
      </div>
    </section>

    <div id="coach-tip" class="coach hidden" role="status" aria-live="polite">
      <span class="coach-text"></span>
      <button class="coach-close" aria-label="Sluiten">✕</button>
    </div>
  </main>

  <!-- =================== SHARE SHEET =================== -->
  <div id="sheet-backdrop" class="sheet-backdrop hidden" aria-hidden="true">
    <section class="sheet" role="dialog" aria-modal="true" aria-labelledby="share-title">
      <header class="sheet-header">
        <div class="drag-indicator" aria-hidden="true"></div>
        <h2 id="share-title">Verstuur je boodschap</h2>
        <button class="sheet-close">✕</button>
      </header>
      <div class="sheet-body">
        <div class="pair-inline" aria-live="polite">
          <span class="pair-label">Voor:</span> <span id="pair-to-val" class="pair-val">—</span>
          <span class="pair-sep">•</span>
          <span class="pair-label">Van:</span> <span id="pair-from-val" class="pair-val">—</span>
        </div>

        <div class="share-grid" role="list">
          <button id="share-whatsapp" class="share-tile" type="button" aria-label="Deel via WhatsApp">
            <img class="tile-icon" src="assets/icons/whatsapp-64.png"
                 srcset="assets/icons/whatsapp-64.png 1x, assets/icons/whatsapp-128.png 2x"
                 width="64" height="64" alt="">
            <span class="tile-label">WhatsApp</span>
          </button>

          <button id="share-email" class="share-tile" type="button" aria-label="Deel via e-mail">
            <img class="tile-icon" src="assets/icons/email-64.png"
                 srcset="assets/icons/email-64.png 1x, assets/icons/email-128.png 2x"
                 width="64" height="64" alt="">
            <span class="tile-label">E-mail</span>
          </button>

          <button id="share-download" class="share-tile" type="button" aria-label="Download als afbeelding">
            <img class="tile-icon" src="assets/icons/download-64.png"
                 srcset="assets/icons/download-64.png 1x, assets/icons/download-128.png 2x"
                 width="64" height="64" alt="">
            <span class="tile-label">Download</span>
          </button>

          <button id="share-copy" class="share-tile" type="button" aria-label="Kopieer link">
            <img class="tile-icon" src="assets/icons/linkcopy-64.png"
                 srcset="assets/icons/linkcopy-64.png 1x, assets/icons/linkcopy-128.png 2x"
                 width="64" height="64" alt="">
            <span class="tile-label">Kopieer</span>
          </button>

          <button id="share-confirm" class="share-tile" type="button" aria-label="Deel met apps">
            <img class="tile-icon" src="assets/icons/share-64.png"
                 srcset="assets/icons/share-64.png 1x, assets/icons/share-128.png 2x"
                 width="64" height="64" alt="">
            <span class="tile-label">Deel</span>
          </button>

          <button id="share-messenger" class="share-tile" type="button" aria-label="Deel via Messenger">
            <img class="tile-icon" src="assets/icons/messenger-64.png"
                 srcset="assets/icons/messenger-64.png 1x, assets/icons/messenger-128.png 2x"
                 width="64" height="64" alt="">
            <span class="tile-label">Messenger</span>
          </button>

          <button id="share-qr" class="share-tile" type="button" aria-label="Toon QR-code">
            <img class="tile-icon" src="assets/icons/qr-64.png"
                 srcset="assets/icons/qr-64.png 1x, assets/icons/qr-128.png 2x"
                 width="64" height="64" alt="">
            <span class="tile-label">QR code</span>
          </button>
        </div>
      </div>

      <footer class="sheet-actions">
        <button class="btn sheet-close" type="button">Sluiten</button>
      </footer>
    </section>
  </div>

  <!-- =================== MESSENGER HELP SHEET =================== -->
  <div id="msgr-help-backdrop" class="sheet-backdrop hidden" aria-hidden="true">
    <section class="sheet sheet--msgr" role="dialog" aria-modal="true" aria-labelledby="msgr-title">
      <header class="sheet-header">
        <h2 id="msgr-title" class="msgr-title">
          <img class="msgr-ico" src="assets/icons/messenger-64.png"
               srcset="assets/icons/messenger-64.png 1x, assets/icons/messenger-128.png 2x"
               width="24" height="24" alt="" />
          Messenger
        </h2>
        <button class="sheet-close" aria-label="Sluiten">✕</button>
      </header>

      <div class="sheet-body">
        <p class="msgr-notice">Link van jouw persoonlijke bericht is gekopieerd. 📋</p>
        <ol class="msgr-steps">
          <li>Kies een contact in Messenger.</li>
          <li>Plak de link in het berichtveld.</li>
          <li>Verstuur je warme note. 💛</li>
        </ol>

        <div class="sheet-actions">
          <button id="msgr-open" class="btn primary" type="button">Open Messenger</button>
          <button id="msgr-close" class="btn" type="button">Sluiten</button>
        </div>
      </div>
    </section>
  </div>

  <!-- =================== QR SHEET =================== -->
  <div id="qr-backdrop" class="sheet-backdrop hidden" aria-hidden="true">
    <section class="sheet sheet--qr" role="dialog" aria-modal="true" aria-labelledby="qr-title">
      <header class="sheet-header">
        <h2 id="qr-title">QR-code</h2>
        <button class="sheet-close" aria-label="Sluiten">✕</button>
      </header>
      <div class="sheet-body">
        <p class="qr-hint">Scan deze code met je telefoon om de note te openen.</p>
        <div class="qr-box">
          <canvas id="qr-canvas" width="240" height="240"></canvas>
        </div>
        <div class="sheet-actions">
          <button id="qr-download" class="btn primary" type="button">Download QR</button>
          <button id="qr-copy" class="btn" type="button">Kopieer link</button>
          <button id="qr-close" class="btn" type="button">Sluiten</button>
        </div>
      </div>
    </section>
  </div>

  <!-- =================== ABOUT SHEET =================== -->
  <div id="about-backdrop" class="sheet-backdrop hidden" aria-hidden="true">
    <section class="sheet sheet--about" role="dialog" aria-modal="true" aria-labelledby="about-title">
      <header class="sheet-header">
        <div class="drag-indicator" aria-hidden="true"></div>
        <h2 id="about-title">Over deze site</h2>
        <button class="sheet-close" aria-label="Sluiten">✕</button>
      </header>
      <div class="about-tapes" aria-hidden="true"></div>

      <div class="sheet-body">
        <p><strong>a warm note — to someone you care about</strong></p>
        <p>Kleine kattebelletjes met grote betekenis. Een app waar je liefdevolle, grappige of bemoedigende notities kunt sturen. Even, al is het maar kort, laten weten dat je aan iemand denkt.</p>
        <div class="about-hero" aria-hidden="true">
          <span class="about-emoji">💛</span>
          <span class="about-tag">Iets kleins, veel betekenis</span>
        </div>
      </div>
      <footer class="sheet-actions">
        <button class="btn" id="about-close">Sluiten</button>
      </footer>
    </section>
  </div>

  <!-- =================== SPLASH OVERLAY (blijft bestaan) =================== -->
  <div id="splash-note-overlay" aria-hidden="true">
    <div class="splash-note-wrap splash-enter" id="splashNoteWrap"></div>
  </div>

  <!-- =================== PERSISTENTE ABOUT FAB RECHTSONDER =================== -->
  <button id="about-fab-fixed" class="btn about-fab" type="button" aria-label="Over deze site" title="Over deze site">ℹ︎</button>

  <!-- =================== DIVERSE LAYERS =================== -->
  <div id="toast" class="toast hidden" role="status" aria-live="polite"></div>
  <div id="confetti-layer" class="vh" aria-live="polite">Viering: berichtje verstuurd.</div>

  <!-- =================== SCRIPTS =================== -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js" defer></script>
  <script defer src="script.js?v=dev5"></script>
  <script defer src="mail.js?v=dev5"></script>
  <script defer src="whatsapp.js?v=dev5"></script>
  <script defer src="download.js?v=dev5"></script>

  <!-- helpers -->
  <style>.vh{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap;}</style>
<script>
  // Alleen in productie registreren, nooit op localhost of via file://
  const isLocalhost = ['localhost','127.0.0.1','::1'].includes(location.hostname);
  if ('serviceWorker' in navigator && !isLocalhost && location.protocol === 'https:') {
    navigator.serviceWorker.register('/sw.js').catch(()=>{});
  }
</script>
</body>
</html>